<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Soft Robotics Project</title>

  <style>
    :root{
      /* Light, plot-friendly theme */
      --bg:#f3f4f6;
      --card:#ffffff;
      --text:#111827;
      --muted:#4b5563;
      --line:#e5e7eb;
      --accent:#2563eb;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background: var(--bg);
      line-height:1.6;
    }

    a{ color:var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    .wrap{ max-width:980px; margin:0 auto; padding:40px 18px 70px; }
    .back{ display:inline-block; margin-bottom:18px; }

    header{
      padding-bottom:18px;
      border-bottom:1px solid var(--line);
      margin-bottom:18px;
    }
    h1{ margin:0 0 6px; font-size:30px; }

    .grid{
      display:grid;
      gap:16px;
      grid-template-columns: 1fr; /* one card per row always */
      margin-top:16px;
    }

    .card{
      border:1px solid var(--line);
      background: var(--card);
      border-radius:16px;
      padding:18px;
      box-shadow: var(--shadow);

      opacity: 0;
      transform: translateY(10px);
      animation: cardIn 500ms ease-out forwards;

      transition: transform 600ms ease, box-shadow 600ms ease;

      display:flex;
      gap:18px;
      align-items:flex-start;
    }
    .card:hover{
      transform: translateY(-2px);
      box-shadow: 0 12px 36px rgba(0,0,0,.10);
    }

    @keyframes cardIn{ to { opacity: 1; transform: translateY(0); } }
    .card:nth-child(1){ animation-delay: 80ms; }
    .card:nth-child(2){ animation-delay: 160ms; }
    .card:nth-child(3){ animation-delay: 240ms; }
    .card:nth-child(4){ animation-delay: 320ms; }
    .card:nth-child(5){ animation-delay: 400ms; }
    .card:nth-child(6){ animation-delay: 480ms; }
    .card:nth-child(7){ animation-delay: 560ms; }

    .card-left{
      flex: 1 1 auto;
      min-width: 0;
    }
    .card-right{
      flex: 0 0 clamp(280px, 38%, 380px);
      min-width: 260px;
    }

    @media (max-width: 820px){
      .card{ flex-direction: column; }
      .card-right{
        flex: 1 1 auto;
        min-width: 0;
        width: 100%;
      }
    }

    h2{ margin:0 0 10px; font-size:18px; }
    p{ margin:0 0 12px; color:var(--muted); }

    ul{
      margin: 0;
      padding-left: 18px;
      color: var(--muted);
    }
    li{ margin: 8px 0; }

    /* Plot-friendly figure surface */
    .figure{
      margin: 12px 0 0;
      background: #ffffff;
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px;
    }

    .shot{
      width:100%;
      border-radius:10px;
      border:0;
      display:block;
      background:#ffffff; /* helps if PNG has transparency */
      will-change: transform;
    }

    .caption{
      margin-top:8px;
      font-size:13px;
      color:var(--muted);

      line-height: 1.35;
      min-height: calc(1.35em * 2); /* reserve exactly 2 lines */
      overflow: hidden;

      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    /* ===== DH table (inline-friendly) ===== */
    .dh-table-wrap{
      margin: 12px 0 0;
      overflow-x: auto;               /* allows scroll on small screens */
      -webkit-overflow-scrolling: touch;
    }
    
    .dh-table{
      width: 100%;
      border-collapse: collapse;
      min-width: 535px;               /* prevents crushed columns */
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 12px;
      overflow: hidden;
    }
    
    .dh-table th,
    .dh-table td{
      border-bottom: 1px solid var(--line);
      text-align: left;
      vertical-align: top;
      font-size: 14px;
      padding: 8px 8px;
      color: var(--text);
      white-space: nowrap;
    }
    
    .dh-table thead th{
      background: #f8fafc;            /* subtle header tint */
      font-weight: 600;
    }
    
    .dh-table tbody tr:last-child td{
      border-bottom: 0;
    }
    
    .dh-caption{
      margin-top: 6px;
      font-size: 13px;
      color: var(--muted);
    }
    
    .math{
      font-variant-numeric: lining-nums;
    }

    

    .btns{ display:flex; gap:10px; flex-wrap:wrap; margin-top:8px; }

    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      padding:9px 12px; border-radius:10px;
      border:1px solid var(--line);
      background: #ffffff;
      color: var(--text);
      min-width:120px;
      cursor:pointer;
    }

    .btn.primary{
      background: rgba(37,99,235,.10);
      border-color: rgba(37,99,235,.35);
      color: var(--text);
    }

    /* ===== Click-to-swipe rotator ===== */
    .rotator{
      position: relative;
      overflow: hidden;
      border-radius: 10px; /* match image radius */
    }

    .rotator-btn{
      position: absolute;
      top: 0;
      height: 100%;
      width: 72px;
      border: 0;
      padding: 0;
      cursor: pointer;
      transition: opacity 160ms ease;
      background: none;

      opacity: 0;
      pointer-events: none;
    }

    @media (hover: hover) and (pointer: fine){
      .rotator:hover .rotator-btn{
        opacity: 1;
        pointer-events: auto;
      }
    }

    @media (hover: none), (pointer: coarse){
      .rotator-btn{
        opacity: 1;
        pointer-events: auto;
      }
    }

    .rotator-prev{
      left: 0;
      background: linear-gradient(
        to right,
        rgba(17,24,39,.22),
        rgba(17,24,39,.08),
        rgba(17,24,39,0)
      );
    }

    .rotator-next{
      right: 0;
      background: linear-gradient(
        to left,
        rgba(17,24,39,.22),
        rgba(17,24,39,.08),
        rgba(17,24,39,0)
      );
    }

    .rotator-btn::before{
      content:"";
      position:absolute;
      top:50%;
      width: 14px;
      height: 14px;
      border-right: 4px solid rgba(17,24,39,.90);
      border-top: 4px solid rgba(17,24,39,.90);
      transform: translateY(-50%);
      filter: drop-shadow(0 2px 2px rgba(0,0,0,.15));
      z-index: 1;
    }

    .rotator-btn::after{
      content:"";
      position:absolute;
      top:50%;
      width: 30px;
      height: 30px;
      transform: translateY(-50%);
      border-radius: 999px;
      background: rgba(255,255,255,.65);
      box-shadow: 0 2px 10px rgba(0,0,0,.12);
      z-index: 0;
    }

    .rotator-prev::before{
      left:18px;
      transform: translateY(-50%) rotate(-135deg);
    }
    .rotator-prev::after{ left:14px; }

    .rotator-next::before{
      right:18px;
      transform: translateY(-50%) rotate(45deg);
    }
    .rotator-next::after{ right:14px; }

    .rotator-swipe-left-out{
      transform: translateX(-100%);
      transition: transform 450ms ease;
    }
    .rotator-swipe-right-out{
      transform: translateX(100%);
      transition: transform 450ms ease;
    }

    .rotator-overlay{
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: auto;
      display: block;
      border-radius: 10px;
      border: 0;
      will-change: transform;
      pointer-events: none;
      transition: transform 450ms ease;
      background: #ffffff;
    }

    /* ===== Modal ===== */
    .modal{
      position: fixed;
      inset: 0;
      display: none;
      z-index: 999;
    }
    .modal[aria-hidden="false"]{
      display: block;
    }

    .modal-backdrop{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(3px);
    }

    .modal-panel{
      position: relative;
      max-width: 980px;
      margin: 6vh auto;
      padding: 0 18px;
    }

    .modal-card{
      position: relative;
      border:1px solid var(--line);
      background: #ffffff;
      border-radius: 18px;
      padding: 18px;
      box-shadow: 0 18px 55px rgba(0,0,0,.18);

      display:flex;
      gap:18px;
      align-items:flex-start;
    }

    @media (max-width: 820px){
      .modal-panel{ margin: 4vh auto; }
      .modal-card{ flex-direction: column; }
    }

    .modal-close{
      position:absolute;
      top: 12px;
      right: 12px;
      width: 38px;
      height: 38px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: #ffffff;
      color: var(--text);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      line-height: 1;
    }

    .modal-title{
      margin: 0 0 10px;
      font-size: 18px;
      color: var(--text);
    }

    /* inline button inside list item (small) */
    .btn.inline{
      padding: 6px 10px;
      min-width: auto;
      border-radius: 10px;
      font-size: 13px;
      margin-left: 10px;
      vertical-align: middle;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <a class="back" href="../../">← Back</a>

    <header>
      <h1>Desktop Manipulator</h1>
    </header>

    <main class="grid">

      <!-- Objective (text-only) -->
      <section class="card">
        <div class="card-left">
          <h2>Objective</h2>
          <p>
            Context (at least some, for desktop work, max workspace volume,
            reasonable time interval and velocity and acc) im struggling with this
          </p>
        </div>
      </section>

      <!-- Configuration -->
      <section class="card">
        <div class="card-left">
          <h2>Configuration</h2>
          <p>
            The manipulator consists of 3 _____ consecutive revolute joints and a prismatic joint
            attached by a L shaped end effector.
            The key dimensions were listed as standard DH parameters in the DH table to the right.
          </p>
              <!-- DH table  -->
          <div class="dh-table-wrap" aria-label="DH parameters table">
            <table class="dh-table">
              <thead>
                <tr>
                  <th>i</th>
                  <th>link length <span class="math">a<sub>i−1</sub></span></th>
                  <th>link twist <span class="math">α<sub>i−1</sub></span></th>
                  <th>link offset <span class="math">d<sub>i</sub></span></th>
                  <th>joint angle <span class="math">θ<sub>i</sub></span></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td>0</td>
                  <td>0</td>
                  <td>L<sub>1</sub> = 35&nbsp;cm</td>
                  <td>θ<sub>1</sub> ∈ (−π, π]</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>L<sub>2</sub> = 25&nbsp;cm</td>
                  <td>−π/2</td>
                  <td>0</td>
                  <td>θ<sub>2</sub> ∈ (−π, 0]</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>0</td>
                  <td>−π/2</td>
                  <td>L<sub>3</sub> = 2&nbsp;cm</td>
                  <td>θ<sub>3</sub> ∈ (−π, π]</td>
                </tr>
                <tr>
                  <td>4</td>
                  <td>L<sub>4</sub> = 10&nbsp;cm</td>
                  <td>0</td>
                  <td>d<sub>4</sub> ∈ [5&nbsp;cm, 15&nbsp;cm]</td>
                  <td>0</td>
                </tr>
                <tr>
                  <td>e</td>
                  <td>−L<sub>4</sub>/2</td>
                  <td>0</td>
                  <td>L<sub>4</sub>/2</td>
                  <td>0</td>
                </tr>
              </tbody>
            </table>
            <div class="dh-caption">DH parameters</div>
          </div>
          <!-- /DH table -->
          
        </div>

        <div class="card-right">
          <div class="figure">
            <div class="rotator">
              <img
                class="shot js-rotator"
                data-images="./img/configuration_m.png,./img/swollen.jpg,./img/bent_gel.png"
                data-captions='[
                  "Hydrogel polymerization using an optimised molding system",
                  "Swollen hydrogel beams, after equilibration in NaCl solution",
                  "A bending hydrogel beam fixed in a NaCl solution under an electric field"
                ]'
                src="./img/configuration_m.png"
                alt="Experimental methodology"
              >
              <button class="rotator-btn rotator-prev" type="button" aria-label="Previous image"></button>
              <button class="rotator-btn rotator-next" type="button" aria-label="Next image"></button>
            </div>

            <div class="caption js-rotator-caption">
              Hydrogel polymerization using an optimised molding system
            </div>
          </div>
        </div>
      </section>

      <!-- Kinematics -->
      <section class="card">
        <div class="card-left">
          <h2>Kinematics</h2>
          <ul>
            <li>
              I derived the Forward Kinematics (FK) of the manipulator
              , which was later used in workspace generation and trajectroy planning.
              <button class="btn inline primary" type="button" data-open-modal="FK-modal">See more</button>
            </li>
            
            <li>
              I derived and analysed the Inverse Kinematics (IK) of the manipulator, and back checked it using FK.
              <button class="btn inline primary" type="button" data-open-modal="IK-modal">See more</button>
            </li>

            <li>
              I derived the Jacobian of the manipulator.
              <button class="btn inline primary" type="button" data-open-modal="Jacobian-modal">See more</button>
            </li>
            
          </ul>
        </div>

        <div class="card-right">
          <div class="figure">
            <div class="rotator">
              <img
                class="shot js-rotator"
                data-images="./img/flowchart1.png,./img/flowchart2.png,./img/flowchart3.png"
                data-captions='[
                  "Flowchart of the computational methodology (step 1)",
                  "Flowchart of the computational methodology (step 2)",
                  "Flowchart of the computational methodology (step 3)"
                ]'
                src="./img/flowchart1.png"
                alt="Simulational methodology"
              >
              <button class="rotator-btn rotator-prev" type="button" aria-label="Previous image"></button>
              <button class="rotator-btn rotator-next" type="button" aria-label="Next image"></button>
            </div>

            <div class="caption js-rotator-caption">
              Flowchart of the computational methodology (step 1)
            </div>
          </div>
        </div>
      </section>

      <!-- Workspace -->
      <section class="card">
        <div class="card-left">
          <h2>Workspace</h2>
          <p>
            I generated a visualisation of the workspace using … in python. (Replace with final text.)
          </p>
        </div>

        <div class="card-right">
          <div class="figure">
            <div class="rotator">
              <img
                class="shot js-rotator"
                data-images="./img/swell_data.png,./img/bend_data.png"
                data-captions='[
                  "Hydrogel swollen width vs crosslinker ratio and NaCl concentration",
                  "Deformation responses of hydrogel beams under parameter combinations"
                ]'
                src="./img/swell_data.png"
                alt="Experimental results"
              >
              <button class="rotator-btn rotator-prev" type="button" aria-label="Previous image"></button>
              <button class="rotator-btn rotator-next" type="button" aria-label="Next image"></button>
            </div>

            <div class="caption js-rotator-caption">
              Hydrogel swollen width vs crosslinker ratio and NaCl concentration
            </div>
          </div>
        </div>
      </section>

      <!-- Trajectory Planning -->
      <section class="card">
        <div class="card-left">
          <h2>Trajectory Planning</h2>
          <ul>
            <li>
              Based on 12 via points and a time interval of … s, I generated time histories of joint position,
              velocity, and acceleration. (Replace with final numbers.)
            </li>
            <li>I generated the corresponding end-effector trajectory.</li>
            <li>I compared two interpolation methods and discussed tradeoffs.</li>
            <li>I performed a self-collision examination along the planned trajectory.</li>
          </ul>
        </div>

        <div class="card-right">
          <div class="figure">
            <div class="rotator">
              <img
                class="shot js-rotator"
                data-images="./img/voltage_varing.png,./img/ionic_electric.png,./img/dis_press.png,./img/difflen.png,./img/diverge.png,./img/solver_break.png"
                data-captions='[
                  "Simulated hydrogel width and displacement at different electric field strengths, validated against experimental results",
                  "An illustration of simulated ionic and electric potential distribution across the computational domain",
                  "An illustration of simulated displacement and fluid pressure distribution across the computational domain",
                  "Validation: deviation of simulated swollen width against different computational domain lengths",
                  "Convergence analysis of the simulation algorithm",
                  "An illustration of a solver breakdown scenario within the algorithm"
                ]'
                src="./img/voltage_varing.png"
                alt="Simulational results"
              >
              <button class="rotator-btn rotator-prev" type="button" aria-label="Previous image"></button>
              <button class="rotator-btn rotator-next" type="button" aria-label="Next image"></button>
            </div>

            <div class="caption js-rotator-caption">
              Simulated hydrogel width and displacement at different electric field strengths, validated against experimental results
            </div>
          </div>
        </div>
      </section>

      <!-- Future Work -->
      <section class="card">
        <div class="card-left">
          <h2>Future Work</h2>
          <ul>
            <li>Use deterministic global nonlinear solvers and more compute to improve numerical consistency.</li>
            <li>Investigate usable parameter ranges computationally before experimental matching.</li>
          </ul>
        </div>
      </section>

    </main>
  </div>

  <!-- ===== Modal for FK ===== -->
  <div class="modal" id="FK-modal" aria-hidden="true" aria-labelledby="FK-title" role="dialog">
    <div class="modal-backdrop" data-close-modal="FK-modal"></div>

    <div class="modal-panel" role="document">
      <div class="modal-card">
        <button class="modal-close" type="button" aria-label="Close" data-close-modal="FK-modal">×</button>

        <div class="card-left">
          <h2 class="modal-title" id="FK-title">Fact20 — Additional Details</h2>
          <p>Put your extended explanation here.</p>
          <ul>
            <li>What Fact20 means in context</li>
            <li>Why it matters to the methodology/results</li>
            <li>Any quantified observation or constraint</li>
          </ul>
        </div>

        <div class="card-right">
          <div class="figure">
            <div class="rotator">
              <img
                class="shot js-rotator"
                data-images="./img/post_gel.jpg,./img/swollen.jpg,./img/bent_gel.png"
                data-captions='[
                  "Hydrogel polymerization using an optimised molding system",
                  "Swollen hydrogel beams, after equilibration in NaCl solution",
                  "A bending hydrogel beam fixed in a NaCl solution under an electric field"
                ]'
                src="./img/post_gel.jpg"
                alt="Fact20 details"
              >
              <button class="rotator-btn rotator-prev" type="button" aria-label="Previous image"></button>
              <button class="rotator-btn rotator-next" type="button" aria-label="Next image"></button>
            </div>

            <div class="caption js-rotator-caption">
              Hydrogel polymerization using an optimised molding system
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- ===== Modal for JK ===== -->
  <div class="modal" id="JK-modal" aria-hidden="true" aria-labelledby="JK-title" role="dialog">
    <div class="modal-backdrop" data-close-modal="JK-modal"></div>

    <div class="modal-panel" role="document">
      <div class="modal-card">
        <button class="modal-close" type="button" aria-label="Close" data-close-modal="JK-modal">×</button>

        <div class="card-left">
          <h2 class="modal-title" id="JK-title">Fact20 — Additional Details</h2>
          <p>Put your extended explanation here.</p>
          <ul>
            <li>What Fact20 means in context</li>
            <li>Why it matters to the methodology/results</li>
            <li>Any quantified observation or constraint</li>
          </ul>
        </div>

        <div class="card-right">
          <div class="figure">
            <div class="rotator">
              <img
                class="shot js-rotator"
                data-images="./img/post_gel.jpg,./img/swollen.jpg,./img/bent_gel.png"
                data-captions='[
                  "Hydrogel polymerization using an optimised molding system",
                  "Swollen hydrogel beams, after equilibration in NaCl solution",
                  "A bending hydrogel beam fixed in a NaCl solution under an electric field"
                ]'
                src="./img/post_gel.jpg"
                alt="Fact20 details"
              >
              <button class="rotator-btn rotator-prev" type="button" aria-label="Previous image"></button>
              <button class="rotator-btn rotator-next" type="button" aria-label="Next image"></button>
            </div>

            <div class="caption js-rotator-caption">
              Hydrogel polymerization using an optimised molding system
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

    <!-- ===== Modal for Jacobian ===== -->
  <div class="modal" id="Jacobian-modal" aria-hidden="true" aria-labelledby="Jacobian-title" role="dialog">
    <div class="modal-backdrop" data-close-modal="Jacobian-modal"></div>

    <div class="modal-panel" role="document">
      <div class="modal-card">
        <button class="modal-close" type="button" aria-label="Close" data-close-modal="Jacobian-modal">×</button>

        <div class="card-left">
          <h2 class="modal-title" id="Jacobian-title">Fact20 — Additional Details</h2>
          <p>Put your extended explanation here.</p>
          <ul>
            <li>What Fact20 means in context</li>
            <li>Why it matters to the methodology/results</li>
            <li>Any quantified observation or constraint</li>
          </ul>
        </div>

        <div class="card-right">
          <div class="figure">
            <div class="rotator">
              <img
                class="shot js-rotator"
                data-images="./img/post_gel.jpg,./img/swollen.jpg,./img/bent_gel.png"
                data-captions='[
                  "Hydrogel polymerization using an optimised molding system",
                  "Swollen hydrogel beams, after equilibration in NaCl solution",
                  "A bending hydrogel beam fixed in a NaCl solution under an electric field"
                ]'
                src="./img/post_gel.jpg"
                alt="Fact20 details"
              >
              <button class="rotator-btn rotator-prev" type="button" aria-label="Previous image"></button>
              <button class="rotator-btn rotator-next" type="button" aria-label="Next image"></button>
            </div>

            <div class="caption js-rotator-caption">
              Hydrogel polymerization using an optimised molding system
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
  (() => {
    const SWIPE_MS = 450;

    function parseList(str) {
      return (str || "")
        .split(",")
        .map(s => s.trim())
        .filter(Boolean);
    }

    function parseJsonArray(str) {
      if (!str) return [];
      try {
        const arr = JSON.parse(str);
        return Array.isArray(arr) ? arr.map(v => String(v)) : [];
      } catch {
        return [];
      }
    }

    function preload(urls) {
      urls.forEach(u => { const i = new Image(); i.src = u; });
    }

    function initClickRotator(img) {
      const rawUrls = parseList(img.dataset.images);
      if (rawUrls.length <= 1) return;

      const urls = rawUrls.map(u => new URL(u, document.baseURI).href);
      const captions = parseJsonArray(img.dataset.captions);

      const figure = img.closest(".figure");
      const rotator = img.closest(".rotator");
      const captionEl = figure?.querySelector(".js-rotator-caption") || null;
      const nextBtn = rotator?.querySelector(".rotator-next") || null;
      const prevBtn = rotator?.querySelector(".rotator-prev") || null;

      if (!rotator || !nextBtn || !prevBtn) return;

      preload(rawUrls);

      const currentSrc = img.currentSrc || img.getAttribute("src") || rawUrls[0];
      const currentHref = new URL(currentSrc, document.baseURI).href;
      let idx = urls.indexOf(currentHref);
      if (idx === -1) idx = 0;

      if (captionEl) captionEl.textContent = captions[idx] ?? captionEl.textContent ?? "";

      let busy = false;

      function go(delta) {
        if (busy) return;
        busy = true;

        const nextIdx = (idx + delta + urls.length) % urls.length;

        const overlay = document.createElement("img");
        overlay.className = "rotator-overlay";
        overlay.alt = img.alt || "Rotating image";
        overlay.src = urls[nextIdx];

        overlay.style.transform = (delta === 1) ? "translateX(100%)" : "translateX(-100%)";

        rotator.appendChild(overlay);
        overlay.getBoundingClientRect();

        img.classList.add(delta === 1 ? "rotator-swipe-left-out" : "rotator-swipe-right-out");
        overlay.style.transform = "translateX(0)";

        window.setTimeout(() => {
          img.src = urls[nextIdx];
          idx = nextIdx;

          if (captionEl) captionEl.textContent = captions[idx] ?? "";

          img.classList.remove("rotator-swipe-left-out", "rotator-swipe-right-out");
          overlay.remove();

          nextBtn.blur();
          prevBtn.blur();

          busy = false;
        }, SWIPE_MS);
      }

      nextBtn.addEventListener("click", (e) => {
        go(1);
        e.currentTarget.blur();
      });

      prevBtn.addEventListener("click", (e) => {
        go(-1);
        e.currentTarget.blur();
      });
    }

    document.querySelectorAll("img.js-rotator").forEach(initClickRotator);

    function openModal(modalId) {
      const modal = document.getElementById(modalId);
      if (!modal) return;

      modal.setAttribute("aria-hidden", "false");
      document.body.style.overflow = "hidden";

      const closeBtn = modal.querySelector("[data-close-modal]");
      if (closeBtn) closeBtn.focus();
    }

    function closeModal(modalId) {
      const modal = document.getElementById(modalId);
      if (!modal) return;

      modal.setAttribute("aria-hidden", "true");
      document.body.style.overflow = "";
    }

    document.addEventListener("click", (e) => {
      const openBtn = e.target.closest("[data-open-modal]");
      if (openBtn) {
        openModal(openBtn.getAttribute("data-open-modal"));
        return;
      }

      const closeBtn = e.target.closest("[data-close-modal]");
      if (closeBtn) {
        closeModal(closeBtn.getAttribute("data-close-modal"));
        return;
      }
    });

    document.addEventListener("keydown", (e) => {
      if (e.key !== "Escape") return;
      const openModalEl = document.querySelector('.modal[aria-hidden="false"]');
      if (!openModalEl) return;
      closeModal(openModalEl.id);
    });
  })();
  </script>
</body>
</html>


